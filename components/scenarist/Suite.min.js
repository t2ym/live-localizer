function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(root,factory){"use strict";if("function"==typeof define&&define.amd)define([],function(){return root.Suite=root.Suite||factory()});else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=factory();try{if(new Function("return class $$A$$ {}"),!module.exports.toString().match(/^class /))throw new Error("Suite.min.js requires babel-runtime")}catch(e){module.exports._createClass=module.exports._createClass||require("babel-runtime/helpers/_create-class.js").default,module.exports._classCallCheck=module.exports._classCallCheck||require("babel-runtime/helpers/_class-call-check.js").default,module.exports._possibleConstructorReturn=module.exports._possibleConstructorReturn||require("babel-runtime/helpers/_possible-constructor-return.js").default,module.exports._inherits=module.exports._inherits||require("babel-runtime/helpers/_inherits.js").default}}else root.Suite=root.Suite||factory()}(this,function(){"use strict";return function(){function Suite(target){var description=arguments.length>1&&void 0!==arguments[1]?arguments[1]:target+" suite";if(_classCallCheck(this,Suite),"Suite"===Suite._name(this.constructor)){this.scope=target||"",this.description=description,this.classes={},this.leafClasses={},this.leafScenarios={},this.branchScenarios={},this.mixins={},this.constructor.scopes=this.constructor.scopes||{},this.constructor.scopes[this.scope]=this,this.classSyntaxSupport=!0,this.arrowFunctionSupport=!0;try{new Function("return class A {}")}catch(e){this.classSyntaxSupport=!1}Suite.toString().match(/^class /)||(this.classSyntaxSupport=!1);try{new Function("return () => 1")}catch(e){this.arrowFunctionSupport=!1}}else this.target=target}return _createClass(Suite,null,[{key:"reconnectable",get:function(){return!0}},{key:"skipAfterFailure",get:function(){return!1}}]),_createClass(Suite,[{key:"uncamel",value:function(name){return name.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/[ ]{1,}/g," ").replace(/^ /,"").toLowerCase()}},{key:"_checkIdentifier",value:function(name){try{var f=new Function("return function "+name+" () {}")();if(f.name!==name||!this.constructor.allowUnicodeNames&&!f.name.match(/^[$\w]*$/))throw new Error(name+" is defined as "+f.name)}catch(e){throw new Error(this.constructor.name+"."+this.scope+":_checkIdentifier "+name+" is not a valid identifier "+e.message)}}},{key:"testClasses",value:function(tests){var self=this;return("number"==typeof tests||tests.match(/^[0-9]$/)?self.test[parseInt(tests)]:tests).split(/,/).map(function(name){if(!self.classes[name])throw new Error("Suite."+self.scope+": Test "+name+" is not defined");return self.classes[name]})}},{key:"updateLeafClasses",value:function(value){var name=Suite._name(value),isLeaf=!0,scenario="",chain=function(proto){for(var chain=[];Suite._name(proto)&&"Suite"!==Suite._name(proto);)chain.unshift(Suite._name(proto)),proto=Object.getPrototypeOf(proto);return chain}(value);for(var i in chain)scenario=scenario?scenario+","+chain[i]:chain[i],i<chain.length-1?(this.branchScenarios[scenario]||(this.branchScenarios[scenario]=!0),this.leafClasses[chain[i]]&&this.leafScenarios[chain[i]]===scenario&&(this.constructor.debug&&console.log("updateLeafClasses "+name+": trim a non-leaf class "+chain[i]+" with scenario "+scenario),delete this.leafClasses[chain[i]],delete this.leafScenarios[chain[i]])):this.branchScenarios[scenario]&&(this.constructor.debug&&console.log("updateLeafClasses "+name+": "+scenario+" is not a leaf"),isLeaf=!1);isLeaf&&(this.leafClasses[name]=value,this.leafScenarios[name]=scenario)}},{key:"generateClasses",value:function(branch,chain){var _this=this;if("string"==typeof branch){var description=branch.split(/;/);description.length>1?(branch=description.shift(),description=description.join(";").replace(/^[\s]*/,"")):description="",this.constructor.debug&&console.log("string",branch||chain[chain.length-1],chain,description),this.generateClass(branch,chain,description)}else if("object"!==(void 0===branch?"undefined":_typeof(branch))||Array.isArray(branch)){if("object"!==(void 0===branch?"undefined":_typeof(branch))||!Array.isArray(branch))throw new Error(this.constructor.name+"."+this.scope+": unknown branch type "+(void 0===branch?"undefined":_typeof(branch))+branch);branch.forEach(function(item){_this.generateClasses(item,chain)})}else if(branch)for(var prop in branch)chain.push(prop),this.generateClasses(branch[prop],chain),chain.pop();else this.constructor.debug&&console.log("null",branch,chain),this.generateClass(branch,chain)}},{key:"generateClass",value:function(name,chain,description){var _this2=this,self=this,expression=void 0;if(!(chain.length>=(chain[0]?1:2)))throw new Error(this.constructor.name+"."+this.scope+":generateClass invalid chain.length "+chain.length);if(name||(name=chain[chain.length-1]),this._checkIdentifier(name),chain[0]){if(this.classes[name])throw new Error(this.constructor.name+"."+this.scope+":generateClass class "+name+" already exists");if(!self.constructor.allowLooseNaming&&this.mixins[name]&&chain[chain.length-1]!==name)throw new Error(this.constructor.name+"."+this.scope+":generateClass mixin "+name+" already exists");chain.forEach(function(c,i){if(self._checkIdentifier(c),0===i)if(self.classes[c])expression="self.classes."+c;else{if(!new Function(self.constructor.name,"return (typeof "+c+' === "function" && (new '+c+"()) instanceof "+self.constructor.name+")")(self.constructor))throw new Error(_this2.constructor.name+"."+_this2.scope+":generateClass global test class "+c+" does not exist");expression=c}else{if(!self.mixins[c])throw new Error(_this2.constructor.name+"."+_this2.scope+":generateClass mixin "+c+" does not exist");expression="self.mixins."+c+"("+expression+")"}}),description&&(description=description.replace(/"/g,'\\"').replace(/\n/g," "));var prefix=this.classSyntaxSupport||"function"!=typeof Suite._createClass||"object"===("undefined"==typeof window?"undefined":_typeof(window))?"":"self.constructor.";expression=1===chain.length&&name===expression?"return "+name:name===chain[chain.length-1]?"return "+expression:self.classSyntaxSupport?"return class "+name+" extends "+expression+(description?' { get description() { return "'+description+'"; } }':" {}"):function(subclass,base,description){return"return ("+function(){return description?function(__BASE_CLASS__){return function(_BASE_CLASS__){function __SUBCLASS__(){return _classCallCheck(this,__SUBCLASS__),_possibleConstructorReturn(this,(__SUBCLASS__.__proto__||Object.getPrototypeOf(__SUBCLASS__)).apply(this,arguments))}return _inherits(__SUBCLASS__,_BASE_CLASS__),_createClass(__SUBCLASS__,[{key:"description",get:function(){return 314159265358}}]),__SUBCLASS__}(__BASE_CLASS__)}:function(__BASE_CLASS__){return function(_BASE_CLASS__2){function __SUBCLASS__(){return _classCallCheck(this,__SUBCLASS__),_possibleConstructorReturn(this,(__SUBCLASS__.__proto__||Object.getPrototypeOf(__SUBCLASS__)).apply(this,arguments))}return _inherits(__SUBCLASS__,_BASE_CLASS__2),__SUBCLASS__}(__BASE_CLASS__)}}().toString().replace(/__cov_[^. ]*[.][a-z]\[\'[0-9]*\'\](\[[0-9]*\])?\+\+[;,]?/g,"").replace(/__SUBCLASS__/g,subclass).replace(/_inherits|_classCallCheck|_createClass|_possibleConstructorReturn/g,prefix+"$&").replace(/ 314159265358;?/g,' "'+description+'";')+")("+base+");"}(name,expression,description),self.classes[name]=new Function("self",expression)(self),self.updateLeafClasses(self.classes[name]),self.constructor.debug&&console.log("generateClass classes."+name+" = "+expression)}else{if(self.mixins[name])throw new Error(this.constructor.name+"."+this.scope+":generateClass mixin "+name+" already exists");if(!self.constructor.allowLooseNaming&&self.classes[name])throw new Error(this.constructor.name+"."+this.scope+":generateClass class "+name+" already exists");chain.forEach(function(c,i){if(self._checkIdentifier(c),0===i)expression="base";else{if(!self.mixins[c])throw new Error(_this2.constructor.name+"."+_this2.scope+":generateClass mixin "+c+" does not exist");expression="self.mixins."+c+"("+expression+")"}}),expression=self.arrowFunctionSupport?"return (base) => "+expression:"return function (base) { return "+expression+"; }",self.mixins[name]=new Function("self",expression)(self),self.constructor.debug&&console.log("generateClass mixins."+name+" = "+expression)}}},{key:"setup",value:function(){return regeneratorRuntime.async(function(_context){for(;;)switch(_context.prev=_context.next){case 0:case"end":return _context.stop()}},null,this)}},{key:"forEvent",value:function(element,type,trigger,condition){return new Promise(function(resolve){element.addEventListener(type,function onEvent(event){(!condition||"boolean"==typeof condition&&condition&&Polymer.dom(event).rootTarget===element||"function"==typeof condition&&condition(element,type,event))&&(element.removeEventListener(type,onEvent),resolve(event))}),trigger&&trigger()})}},{key:"scenario",value:regeneratorRuntime.mark(function scenario(){var steps,proto;return regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:for(steps=[],proto=Object.getPrototypeOf(this);proto.constructor.name&&"Object"!==proto.constructor.name;)steps.unshift({name:proto.hasOwnProperty("description")?proto.description:this.uncamel(Suite._name(proto.constructor)),iteration:proto.hasOwnProperty("iteration")?proto.iteration:void 0,operation:proto.hasOwnProperty("operation")?proto.operation:void 0,checkpoint:proto.hasOwnProperty("checkpoint")?proto.checkpoint:void 0,ctor:proto.constructor}),proto=Object.getPrototypeOf(proto);return _context2.delegateYield(steps,"t0",4);case 4:case"end":return _context2.stop()}},scenario,this)})},{key:"teardown",value:function(){return regeneratorRuntime.async(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:case"end":return _context3.stop()}},null,this)}},{key:"run",value:function(classes,target){var self=this;return"Suite"===Suite._name(self.constructor)?new Promise(function(resolve,reject){try{var testSuites=[];if("number"==typeof classes||"string"==typeof classes)testSuites=self.testClasses(classes);else if("object"===(void 0===classes?"undefined":_typeof(classes))&&Array.isArray(classes))testSuites=classes.map(function(item){return"string"==typeof item?self.classes[item]:item});else if("object"===(void 0===classes?"undefined":_typeof(classes))&&!Array.isArray(classes)&&classes)for(var c in classes)testSuites.push(classes[c]);("function"==typeof suite?suite:describe)(self.description||self.scope+" suite",function(){var _this5=this,testInstances=testSuites.map(function(s){return[Suite._name(s),new s(target)]});Promise.all(testInstances.map(function(instance,index){return regeneratorRuntime.async(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",instance[1].run().then(function(v){return testInstances[index][2]=v}).catch(function(e){return testInstances[index][2]=e}));case 1:case"end":return _context4.stop()}},null,_this5)})).then(function(results){if(results.filter(function(i){return i instanceof Error}).length>0){var MultiError=function(_Error){function MultiError(message,errors){_classCallCheck(this,MultiError);var _this6=_possibleConstructorReturn(this,(MultiError.__proto__||Object.getPrototypeOf(MultiError)).call(this,message));return _this6.errors=errors,_this6}return _inherits(MultiError,_Error),MultiError}(Error),errors=new MultiError(self.constructor.name+"."+self.scope+".run("+testInstances.map(function(item){return item[0]}).join(",")+"): exception(s) thrown. See .errors for details",testInstances);self.constructor.debug&&console.log(self.description+": exception(s) thrown for ",classes,errors,errors.errors),reject(errors)}else self.constructor.debug&&console.log(self.description+": loaded for ",classes),resolve()})})}catch(e){reject(e)}}):new Promise(function(resolve,reject){var exception=void 0,checkExceptionHandler=function(reject,exception){return"function"==typeof self.exception?self.exception(reject,exception):(reject(exception),!0)};try{var overrideToString=function(func,ctor){return func.toString=function(){return ctor.toString()},func};("function"==typeof suite?suite:describe)(Object.getOwnPropertyDescriptor(Object.getPrototypeOf(self),"description")?self.description:self.uncamel(Suite._name(self.constructor)),function(){var _loop,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,step;return regeneratorRuntime.async(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:for(("function"==typeof suiteSetup?suiteSetup:before)(function(){return regeneratorRuntime.async(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,regeneratorRuntime.awrap(self.setup());case 2:case"end":return _context5.stop()}},null,this)}),_context9.prev=1,_loop=function(step){if(step.operation||step.checkpoint)if(step.iteration){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=step.iteration.apply(self)[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var parameters=_step2.value;!function(parameters){("function"==typeof test?test:it)(parameters.name?"function"==typeof parameters.name?parameters.name(parameters):parameters.name:step.name,overrideToString(function(){return regeneratorRuntime.async(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(!self.constructor.skipAfterFailure||!self.__failed){_context6.next=4;break}return _context6.abrupt("return",this.skip());case 4:if(self.__failed=!0,!step.operation){_context6.next=8;break}return _context6.next=8,regeneratorRuntime.awrap(step.operation.call(self,parameters));case 8:if(!step.checkpoint){_context6.next=11;break}return _context6.next=11,regeneratorRuntime.awrap(step.checkpoint.call(self,parameters));case 11:self.__failed=!1;case 12:case"end":return _context6.stop()}},null,this)},step.ctor))}(parameters)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}else("function"==typeof test?test:it)(step.name,overrideToString(function(){return regeneratorRuntime.async(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(!self.constructor.skipAfterFailure||!self.__failed){_context7.next=4;break}return _context7.abrupt("return",this.skip());case 4:if(self.__failed=!0,!step.operation){_context7.next=8;break}return _context7.next=8,regeneratorRuntime.awrap(step.operation.call(self));case 8:if(!step.checkpoint){_context7.next=11;break}return _context7.next=11,regeneratorRuntime.awrap(step.checkpoint.call(self));case 11:self.__failed=!1;case 12:case"end":return _context7.stop()}},null,this)},step.ctor))},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context9.prev=6,_iterator=self.scenario()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)step=_step.value,_loop(step);_context9.next=14;break;case 10:_context9.prev=10,_context9.t0=_context9.catch(6),_didIteratorError=!0,_iteratorError=_context9.t0;case 14:_context9.prev=14,_context9.prev=15,!_iteratorNormalCompletion&&_iterator.return&&_iterator.return();case 17:if(_context9.prev=17,!_didIteratorError){_context9.next=20;break}throw _iteratorError;case 20:return _context9.finish(17);case 21:return _context9.finish(14);case 22:_context9.next=27;break;case 24:_context9.prev=24,_context9.t1=_context9.catch(1),exception=checkExceptionHandler(reject,_context9.t1);case 27:("function"==typeof suiteTeardown?suiteTeardown:after)(function(){return regeneratorRuntime.async(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,regeneratorRuntime.awrap(self.teardown());case 2:case"end":return _context8.stop()}},null,this)});case 28:case"end":return _context9.stop()}},null,this,[[1,24],[6,10,14,22],[15,,17,21]])}),exception||resolve()}catch(e){exception=checkExceptionHandler(reject,e)}})}},{key:"test",set:function(value){if("function"==typeof value){var name=Suite._name(value);if(name){if(this.classes[name])throw new Error(this.constructor.name+"."+this.scope+": class "+name+" already exists");this.classes[name]=value,this.updateLeafClasses(value)}else{if(!(name=Suite._name(value(null))))throw new Error(this.constructor.name+"."+this.scope+": class mixin has no name "+value.toString());if(this.mixins[name])throw new Error(this.constructor.name+"."+this.scope+": class mixin "+name+" already exists");this.mixins[name]=value}}else if("object"===(void 0===value?"undefined":_typeof(value))){if(!value)throw new Error(this.constructor.name+"."+this.scope+": null object is not expected");this.generateClasses(value,[])}},get:function(){var last=void 0;return function(o){return Object.keys(o).map(function(n){return o[n]})}(this.leafClasses).reduce(function(l,c){return c.reconnectable&&last&&last[0].reconnectable?last.push(c):l.push(last=[c]),l},[]).map(function(l){return l.map(function(c){return Suite._name(c)}).join(",")})}}],[{key:"_name",value:function(func){return(func.hasOwnProperty("name")?func.name:func.toString().replace(/^[\S\s]*?function\s*/,"").replace(/[\s\(\/][\S\s]+$/,"")).replace(/^_?class$/,"")}},{key:"repeat",value:function(target,count,subclass){var scenario={};if(count<1)scenario=subclass;else for(scenario[target]=subclass,count--;count-- >0;)scenario=_defineProperty({},target,scenario);return scenario}},{key:"_permute",value:regeneratorRuntime.mark(function _permute(targets){var len,j,swap,append,_iteratorNormalCompletion3,_didIteratorError3,_iteratorError3,_iterator3,_step3,sub,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,result=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},subclass=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(list){return list.join("Then")};return regeneratorRuntime.wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(append=function(){for(var cursor=result,k=0;k<len;k++)cursor[targets[k]]||(cursor[targets[k]]=k>=len-1?subclass(targets):{}),cursor=cursor[targets[k]]},swap=function(){if(j!==i){var tmp=targets[i];targets[i]=targets[j],targets[j]=tmp}},len=targets.length,j=void 0,!(i>=len-1)){_context10.next=10;break}return _context10.next=7,targets;case 7:append(),_context10.next=44;break;case 10:j=i;case 11:if(!(j<len)){_context10.next=44;break}swap(),_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0,_context10.prev=16,_iterator3=this._permute(targets,i+1,result)[Symbol.iterator]();case 18:if(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done){_context10.next=26;break}return sub=_step3.value,_context10.next=22,targets;case 22:append();case 23:_iteratorNormalCompletion3=!0,_context10.next=18;break;case 26:_context10.next=32;break;case 28:_context10.prev=28,_context10.t0=_context10.catch(16),_didIteratorError3=!0,_iteratorError3=_context10.t0;case 32:_context10.prev=32,_context10.prev=33,!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return();case 35:if(_context10.prev=35,!_didIteratorError3){_context10.next=38;break}throw _iteratorError3;case 38:return _context10.finish(35);case 39:return _context10.finish(32);case 40:swap();case 41:j++,_context10.next=11;break;case 44:case"end":return _context10.stop()}},_permute,this,[[16,28,32,40],[33,,35,39]])})},{key:"permute",value:function(targets,subclass){var result={},_iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=this._permute(targets,0,result,subclass)[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){_step4.value}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}return result}}]),Suite}()});
//# sourceMappingURL=Suite.min.js.map
